
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Other Cool Stuff &mdash; django-mongodb-engine v0.2.0 documentation</title>
    <link rel="stylesheet" href="static/nature.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="django-mongodb-engine v0.2.0 documentation" href="index.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Storing Python Lists and Dicts" href="lists-and-dicts.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently Asked Questions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lists-and-dicts.html" title="Storing Python Lists and Dicts"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">django-mongodb-engine v0.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="other-cool-stuff">
<h1>Other Cool Stuff<a class="headerlink" href="#other-cool-stuff" title="Permalink to this headline">¶</a></h1>
<div class="section" id="included-mongodb-batteries">
<span id="mapreduce"></span><h2>Included MongoDB Batteries<a class="headerlink" href="#included-mongodb-batteries" title="Permalink to this headline">¶</a></h2>
<p>For usage examples, see <tt class="file docutils literal"><span class="pre">tests/contrib/tests.py</span></tt>.</p>
<dl class="class">
<dt id="django_mongodb_engine.contrib.MongoDBManager">
<em class="property">class </em><tt class="descclassname">django_mongodb_engine.contrib.</tt><tt class="descname">MongoDBManager</tt><a class="headerlink" href="#django_mongodb_engine.contrib.MongoDBManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django_mongodb_engine.contrib</span> <span class="kn">import</span> <span class="n">MongoDBManager</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">MongoDBManager</span><span class="p">()</span>

<span class="n">MyModel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">map_reduce</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c"># See `MapReduceMixin` documentation</span>
<span class="n">MyModel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">raw_query</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c"># See `RawQueryMixin` documentation</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="raw-queries">
<h3>Raw Queries<a class="headerlink" href="#raw-queries" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django_mongodb_engine.contrib.RawQueryMixin">
<em class="property">class </em><tt class="descclassname">django_mongodb_engine.contrib.</tt><tt class="descname">RawQueryMixin</tt><a class="headerlink" href="#django_mongodb_engine.contrib.RawQueryMixin" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="django_mongodb_engine.contrib.RawQueryMixin.raw_query">
<tt class="descname">raw_query</tt><big>(</big><em>query=None</em><big>)</big><a class="headerlink" href="#django_mongodb_engine.contrib.RawQueryMixin.raw_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Does a raw MongoDB query. The optional parameter <cite>query</cite> is the spec
passed to PyMongo&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">find()</span></tt> method.</p>
<p>Note that you can&#8217;t use regular Django filters and <tt class="xref py py-meth docutils literal"><span class="pre">raw_query()</span></tt>
at the same time. Trying to do so will raise a <tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-django_mongodb_engine.contrib.mapreduce">
<span id="map-reduce-support"></span><h3>Map/Reduce Support<a class="headerlink" href="#module-django_mongodb_engine.contrib.mapreduce" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django_mongodb_engine.contrib.mapreduce.MapReduceMixin">
<em class="property">class </em><tt class="descclassname">django_mongodb_engine.contrib.mapreduce.</tt><tt class="descname">MapReduceMixin</tt><a class="headerlink" href="#django_mongodb_engine.contrib.mapreduce.MapReduceMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixes MapReduce support into your manager.</p>
<dl class="method">
<dt id="django_mongodb_engine.contrib.mapreduce.MapReduceMixin.map_reduce">
<tt class="descname">map_reduce</tt><big>(</big><em>map_func</em>, <em>reduce_func</em>, <em>finalize_func=None</em>, <em>limit=None</em>, <em>scope=None</em>, <em>keeptemp=False</em><big>)</big><a class="headerlink" href="#django_mongodb_engine.contrib.mapreduce.MapReduceMixin.map_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a MapReduce on the server using <cite>map_func</cite>, <cite>reduce_func</cite> and
(optionally) <cite>finalize_func</cite>.</p>
<p>Returns a list of <a class="reference internal" href="#django_mongodb_engine.contrib.mapreduce.MapReduceResult" title="django_mongodb_engine.contrib.mapreduce.MapReduceResult"><tt class="xref py py-class docutils literal"><span class="pre">MapReduceResult</span></tt></a> instances, one instance for
each item in the array the MapReduce query returns.</p>
<p>MongoDB &gt;= 1.1 and PyMongo &gt;= 1.2 are required for using this feature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>map_func</strong> &#8211; JavaScript map function as string</li>
<li><strong>reduce_func</strong> &#8211; The JavaScript reduce function as string</li>
<li><strong>finalize_func</strong> &#8211; (optional) JavaScript finalize function as string</li>
<li><strong>limit</strong> &#8211; (optional) Maximum number of entries to be processed</li>
<li><strong>scope</strong> &#8211; (optional) Variable scope to pass the functions (<a class="reference external" href="http://docs.python.org/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>)</li>
<li><strong>keeptemp</strong> &#8211; Whether to keep the temporarily created collection
(boolean, defaults to <tt class="xref py py-const xref docutils literal"><span class="pre">False</span></tt>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="django_mongodb_engine.contrib.mapreduce.MapReduceResult">
<em class="property">class </em><tt class="descclassname">django_mongodb_engine.contrib.mapreduce.</tt><tt class="descname">MapReduceResult</tt><big>(</big><em>model</em>, <em>key</em>, <em>value</em><big>)</big><a class="headerlink" href="#django_mongodb_engine.contrib.mapreduce.MapReduceResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents one item of a MapReduce result array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> &#8211; the model on that query the MapReduce was performed</li>
<li><strong>key</strong> &#8211; the <em>key</em> from the result item</li>
<li><strong>value</strong> &#8211; the <em>value</em> from the result item</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="django_mongodb_engine.contrib.mapreduce.MapReduceResult.get_object">
<tt class="descname">get_object</tt><big>(</big><big>)</big><a class="headerlink" href="#django_mongodb_engine.contrib.mapreduce.MapReduceResult.get_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the model instance with <tt class="docutils literal"><span class="pre">self.key</span></tt> as primary key from the
database (doing a database query).</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-django_mongodb_engine.fields">
<span id="fields"></span><span id="mongodb-fields"></span><h2>Fields<a class="headerlink" href="#module-django_mongodb_engine.fields" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="django_mongodb_engine.fields.EmbeddedModelField">
<em class="property">class </em><tt class="descclassname">django_mongodb_engine.fields.</tt><tt class="descname">EmbeddedModelField</tt><big>(</big><em>model</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#django_mongodb_engine.fields.EmbeddedModelField" title="Permalink to this definition">¶</a></dt>
<dd><p>Field that allows you to embed a model instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> &#8211; The model class that shall be embedded</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>For example, we want to namespace everything that belongs to a customer&#8217;s
address into the <tt class="docutils literal"><span class="pre">address</span></tt> field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">street</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">postal_code</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">EmbeddedModelField</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#django_mongodb_engine.fields.EmbeddedModelField" title="django_mongodb_engine.fields.EmbeddedModelField"><tt class="xref py py-class docutils literal"><span class="pre">EmbeddedModelField</span></tt></a> behaves similar to relations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bob</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
   <span class="n">name</span><span class="o">=</span><span class="s">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s">&#39;Laxley&#39;</span><span class="p">,</span>
   <span class="n">address</span><span class="o">=</span><span class="n">Address</span><span class="p">(</span><span class="n">street</span><span class="o">=</span><span class="s">&#39;Behind the Mountains 23&#39;</span><span class="p">,</span>
                   <span class="n">postal_code</span><span class="o">=</span><span class="mi">1337</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">&#39;Blurginson&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">bob</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">postal_code</span> <span class="o">==</span> <span class="mi">1337</span>
</pre></div>
</div>
<p>When saved, embedded models are serialized to dictionaries. When queried,
the dictionary will be unserialized back to a model instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bob</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">bob_from_db</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Bob&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">bob_from_db</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">city</span> <span class="o">==</span> <span class="s">&#39;Blurginson&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="collection-options">
<span id="id1"></span><h2>Collection Options<a class="headerlink" href="#collection-options" title="Permalink to this headline">¶</a></h2>
<p>Collection flags can be set in a <tt class="xref py py-class docutils literal"><span class="pre">MongoMeta</span></tt> attribute in a model,
similar to Django&#8217;s <tt class="xref py py-class docutils literal"><span class="pre">Meta</span></tt> class:</p>
<div class="highlight-python"><pre>class MyModel(models.Model):
    # your fields here

    class MongoMeta:
        # your flags here</pre>
</div>
<p>Those flags can be:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">index_together</span></tt> (default: <tt class="docutils literal"><span class="pre">[]</span></tt>)</dt>
<dd><p class="first">A list of dictionaries containing an item with the key <em>field</em> and a list of
field names or <tt class="samp docutils literal"><span class="pre">(</span><em><span class="pre">field</span> <span class="pre">name</span></em><span class="pre">,</span> <em><span class="pre">index</span> <span class="pre">direction</span></em><span class="pre">)</span></tt> tuples to
index together, optionally containing keyword arguments to pass to
<tt class="xref py py-meth docutils literal"><span class="pre">pymongo.Collection.ensure_index()</span></tt>. For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">index_together</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&#39;fields&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;last_name&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
                   <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="s">&#39;name-lastname-index&#39;</span><span class="p">}]</span>
</pre></div>
</div>
<p>results in this call:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">target_collection</span><span class="o">.</span><span class="n">ensure_index</span><span class="p">([(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;last_name&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;name-lastname-index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">descending_indexes</span></tt> (default: <tt class="docutils literal"><span class="pre">[]</span></tt>)</dt>
<dd><p class="first">A list of fields whose index shall be descending rather than ascending.
For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">MongoMeta</span><span class="p">:</span>
        <span class="n">descending_indexes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p class="last">would create an ascending index on field <tt class="docutils literal"><span class="pre">a</span></tt> and a descending one on <tt class="docutils literal"><span class="pre">b</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">capped</span></tt> (default: <tt class="xref py py-const xref docutils literal"><span class="pre">False</span></tt>)</dt>
<dd>A boolean specifying whether the collection for the model shall be capped.</dd>
<dt><tt class="docutils literal"><span class="pre">collection_size</span></tt> and <tt class="docutils literal"><span class="pre">collection_max</span></tt> (default: unset)</dt>
<dd>If using a <tt class="docutils literal"><span class="pre">capped</span></tt> collection, those two options specify the size (in bytes)
and the maximum number of objects of the capped collection, respectively.</dd>
</dl>
</div>
<div class="section" id="automatic-model-instance-de-referencing">
<h2>Automatic Model Instance (De)Referencing<a class="headerlink" href="#automatic-model-instance-de-referencing" title="Permalink to this headline">¶</a></h2>
<p>If you set the <tt class="docutils literal"><span class="pre">MONGODB_AUTOMATIC_REFERENCING</span></tt> option to <tt class="xref py py-class xref docutils literal"><span class="pre">True</span></tt> in
your <tt class="file docutils literal"><span class="pre">settings.py</span></tt>, django-mongodb-engine automatically references
model instances in <a class="reference internal" href="lists-and-dicts.html#ListField" title="ListField"><tt class="xref py py-class docutils literal"><span class="pre">lists</span></tt></a> or <a class="reference internal" href="lists-and-dicts.html#DictField" title="DictField"><tt class="xref py py-class docutils literal"><span class="pre">dicts</span></tt></a> on
saves and dereferences them when you access an attribute.</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently Asked Questions"
             >next</a> |</li>
        <li class="right" >
          <a href="lists-and-dicts.html" title="Storing Python Lists and Dicts"
             >previous</a> |</li>
        <li><a href="index.html">django-mongodb-engine v0.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2010: Flavio Percoco, Alberto Paro, Jonas Haag &amp; contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>